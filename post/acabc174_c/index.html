<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <title>AcABC174C-模运算 - luosuu的小站</title>
  <meta property="og:title" content="AcABC174C-模运算 - luosuu的小站" />
  <meta name="twitter:title" content="AcABC174C-模运算 - luosuu的小站" />
  <meta name="description" content="题面：https://atcoder.jp/contests/abc174/tasks/abc174_c">
  <meta property="og:description" content="题面：https://atcoder.jp/contests/abc174/tasks/abc174_c">
  <meta name="twitter:description" content="题面：https://atcoder.jp/contests/abc174/tasks/abc174_c">
  <meta name="author" content="luosuu"/>
  <meta property="og:site_name" content="luosuu的小站" />
  <meta property="og:url" content="https://example.com/post/acabc174_c/" />
  <meta property="og:type" content="article" />
  <meta name="twitter:card" content="summary" />
  <meta name="generator" content="Hugo 0.73.0" />

  <link rel="stylesheet" href="/css/style.css" media="all" />
  <link rel="stylesheet" href="/css/syntax.css" media="all" />
  <link rel="stylesheet" href="/css/custom.css" media="all" />

  <script src="/js/script.js"></script>
  <script src="/js/custom.js"></script>
  <script defer src="/js/fontawesome.js"></script>
</head>

<body>

<header class="site-header">
  <nav class="site-navi">
    <h1 class="site-title"><a href="/">luosuu的小站</a></h1>
    <ul class="site-navi-items">
      <li class="site-navi-item-categories"><a href="/categories/" title="Categories">Categories</a></li>
      <li class="site-navi-item-tags"><a href="/tags/" title="Tags">Tags</a></li>
      <li class="site-navi-item-archives"><a href="/archives/" title="Archives">Archives</a></li>
      <li class="site-navi-item-about"><a href="/about/" title="About">About</a></li>
    </ul>
  </nav>
</header>
<hr class="site-header-bottom">

  <div class="main" role="main">
    <article class="article">
      
      
      <h1 class="article-title">AcABC174C-模运算</h1>
      
      <hr class="article-title-bottom">
      <ul class="article-meta">
        <li class="article-meta-date"><time>August 4, 2020</time></li>
        <li class="article-meta-categories">
          <a href="/categories/oj/">
            <i class="fas fa-folder"></i>
            OJ
          </a>&nbsp;
        </li>
      </ul>
      
<aside class="toc">
  
</aside>
      <p>题面：<a href="https://atcoder.jp/contests/abc174/tasks/abc174_c">https://atcoder.jp/contests/abc174/tasks/abc174_c</a></p>

<p>本题可以简单化简</p>

<p><span  class="math">\[
K*a=7*\frac{1-10^n}{1-10}
\]</span></p>

<p>等同于</p>

<p><span  class="math">\[
K*a*9=7*(10^n-1)
\]</span></p>

<p>a是K的倍数，n为被除数的位数，n即为所求。只要右侧式能够整除9K（a是个整数），那么就满足要求。</p>

<p>于是调试n，用右侧式对左侧进行取模操作即可。</p>

<p>但计算过程中有$10^n$的限制，可能会超过<code>long long</code>数据的最大值。</p>

<p>这里要引出取模运算的运算规则</p>
<pre><code>(a+b)%p=(a%p+b%p)%p
(a-b)%p=(a%p-b%p)%p
(a*b%p)=(a%p * b%p)%p
(a^b)%p=((a%p)^b)%p</code></pre>
<p>观察右侧式，先抛去7这个乘数，它的变化应该是</p>
<pre><code>9
99
999
...</code></pre>
<p>可以表示为</p>
<pre><code>d(0)=9
d(1)=d(0)*10+9
d(2)=d(1)*10+9
...
d(n)=d(n-1)*10+9</code></pre>
<p>现在要求<code>d(n)</code>能不能整除<code>9K</code>，可以递推式的表达，这样循环中每一次验证都只需要一次计算。</p>

<p>最后考虑停机条件，时间限制为2s，以CPU 1GHz的速度来考虑，保守的可以设置停机条件为2e7。如果2e7位数还没有找到，大概率是没有了。</p>

<p>完整的代码可以写为</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">int</span> K;
    cin <span style="color:#f92672">&gt;&gt;</span> K;
    <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">int</span> s <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span> <span style="color:#f92672">*</span> K;
    <span style="color:#66d9ef">if</span>(K <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> K <span style="color:#f92672">%</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>){
        cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
    }
    <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">int</span> d <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">long</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">20000000</span>;i<span style="color:#f92672">++</span>){
        <span style="color:#66d9ef">if</span>((<span style="color:#ae81ff">7</span><span style="color:#f92672">*</span>d)<span style="color:#f92672">%</span>s<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>){
            cout <span style="color:#f92672">&lt;&lt;</span> i;
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
        }
        d <span style="color:#f92672">=</span> (d<span style="color:#f92672">*</span><span style="color:#ae81ff">10</span><span style="color:#f92672">+</span><span style="color:#ae81ff">9</span>)<span style="color:#f92672">%</span>s;
    }
    cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div>
<h3 id="one-more-thing">one more thing</h3>

<p>关于模运算有很多有趣的知识，其中一些在OJ中经常常用，快速幂就是其中一个。</p>

<p>快速幂的全称是“快速计算一个幂式的模（余）”</p>

<p>假如我们要计算<code>a^b mod c</code></p>

<p>如果我们直接算</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">int</span> ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>b;i<span style="color:#f92672">++</span>)
{
  ans <span style="color:#f92672">=</span> ans <span style="color:#f92672">*</span> a;
}
ans <span style="color:#f92672">=</span> ans <span style="color:#f92672">%</span> c;
</code></pre></div>
<p>那么当b比较大的时候，<code>long long</code>也是撑不住的，数据会溢出。</p>

<p>可以根据模运算的性质<code>(a^b)%p=((a%p)^b)%p</code></p>

<p>在算指数之前先取模，这样可以小一些</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">int</span> ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
a <span style="color:#f92672">=</span> a <span style="color:#f92672">%</span> c;
<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>b;i<span style="color:#f92672">++</span>)
{
  ans <span style="color:#f92672">=</span> ans <span style="color:#f92672">*</span> a;
}
ans <span style="color:#f92672">=</span> ans <span style="color:#f92672">%</span> c;
</code></pre></div>
<p>如果一个因子取余不影响最终结果，那么中间的因子取余应该也是不影响结果的（反正最后都被消掉，可以在计算指数的过程中消掉）</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">int</span> ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
a <span style="color:#f92672">=</span> a <span style="color:#f92672">%</span> c;
<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>b;i<span style="color:#f92672">++</span>)
{
  ans <span style="color:#f92672">=</span> (ans <span style="color:#f92672">*</span> a)<span style="color:#f92672">%</span>c;
}
ans <span style="color:#f92672">=</span> ans <span style="color:#f92672">%</span> c;
</code></pre></div>
<p>现在已经比最开始好很多了，但现在的复杂度式还是<code>O(b)</code>，当b比较大的时候还是有可能超时。</p>

<p>也就是问题出现在求指数的过程中，这里要考虑到如何快速计算幂式，我们可以这样考虑
<span  class="math">\(
2^{1000}=4^{500}
\)</span>
底数做一次平方，运算次数少了一半，如果是奇数
<span  class="math">\(
2^{1001}=4^{500}*2
\)</span>
现在先不考虑幂式求模余的问题，如果单纯要求快速计算<code>a^b</code></p>

<p>方法应该是这样的</p>

<p>当指数b是偶数时，平方底数，指数b自除2；</p>

<p>当指数b是奇数时，先用一个数才收集落单的底数，然后平方底数，b自减1再除2。</p>

<p>最后除到b为1的时候，用于收集落单的底数的数就会乘以最后的底，从而变成最终结果。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">QuickPower</span>(<span style="color:#66d9ef">int</span> a,<span style="color:#66d9ef">int</span> b){
    <span style="color:#66d9ef">int</span> result <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">while</span>(b<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>){
        <span style="color:#66d9ef">if</span>(b <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>){
            result <span style="color:#f92672">=</span> result<span style="color:#f92672">*</span>a;
            b <span style="color:#f92672">=</span> b <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
        }
        b <span style="color:#f92672">=</span> b<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>;
        a <span style="color:#f92672">=</span> a <span style="color:#f92672">*</span> a;
    }
}
</code></pre></div>
<p>如何应用在求幂式的模余中呢？应该是很简单的。</p>

<p>当指数b是偶数时，平方底数，指数b自除2；</p>

<p>当指数b是奇数时，先让ans乘以底数a（这里可以对c取模优化），用于收集落单的底数，然后平方底数，b自减1再除2。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">PowerMod</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b, <span style="color:#66d9ef">int</span> c)
{
    <span style="color:#66d9ef">int</span> ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    a <span style="color:#f92672">=</span> a <span style="color:#f92672">%</span> c;
    <span style="color:#66d9ef">while</span>(b<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>) {
        <span style="color:#66d9ef">if</span>(b <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>){
            ans <span style="color:#f92672">=</span> (ans <span style="color:#f92672">*</span> a) <span style="color:#f92672">%</span> c;
        }
      <span style="color:#75715e">//由于是整形，不减1直接除二也是可以的
</span><span style="color:#75715e"></span>        b <span style="color:#f92672">=</span> b<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>;
     <span style="color:#75715e">// 下面这种写法也是可以的，右移操作也是可以实现除二，并且自动舍去了余数（就是对整数这样操作不tidy）
</span><span style="color:#75715e"></span>     <span style="color:#75715e">// b = b &gt;&gt; 1 
</span><span style="color:#75715e"></span>        a <span style="color:#f92672">=</span> (a <span style="color:#f92672">*</span> a) <span style="color:#f92672">%</span> c;
    }
    <span style="color:#66d9ef">return</span> ans;
}
</code></pre></div>
    </article>

    


    <ul class="pager article-pager">
      <li class="pager-newer">
          <a href="/post/cf661-a/" data-toggle="tooltip" data-placement="top" title="Cf#661 A-输入输出">&lt; Newer</a>
      </li>
      <li class="pager-older">
        <a href="/post/always-know-what-is-important/" data-toggle="tooltip" data-placement="top" title="Always Know What Is Important">Older &gt;</a>
      </li>
    </ul>
  </div>

<script src="https://cdn.bootcss.com/highlight.js/9.18.1/highlight.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</body>
</html>
